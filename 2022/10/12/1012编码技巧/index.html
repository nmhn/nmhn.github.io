<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>编码技巧 笔记 | Hexo</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config={root:"/",path:"search.json"}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:!0,theme:"dark"})</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face{font-family:BenderLight;src:local('Bender'),url(/font/BenderLight.ttf)}@font-face{font-family:'JetBrains Mono';src:local('JetBrains Mono'),url(/font/JetBrainsMono-Regular.woff2) format('woff2')}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg)"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>编码技巧 笔记</h1><div id="post-info"><span>First Post:<div class="control"><time datetime="2022-10-12T01:43:00.000Z" id="date">2022-10-12</time></div></span><br><span>Last Update:<div class="control"><time datetime="2022-10-13T04:42:52.974Z" id="updated">2022-10-13</time></div></span><br><span>Word Count:<div class="control">1.2k</div></span><br><span>Read Time:<div class="control">4 min</div></span></div></div><hr><div id="post-content"><h2 id="1-整洁性"><a href="#1-整洁性" class="headerlink" title="1 整洁性"></a>1 整洁性</h2><ul><li>语义简单明确,优先考虑易于读者理解的写法</li><li>简洁!&#x3D;代码短<ul><li>复杂的问号表达式反而不如 if else 方便理解<ul><li>个人疑问:问号表达式可以一定程度上提供条件数据传送,而非条件转移</li></ul></li></ul></li><li>提前返错<ul><li>提前返回错误判断可以减少主体逻辑的缩进数量,使主体代码逻辑更醒目</li></ul></li><li>利用析构函数做清理工作<ul><li>利用C++析构函数做清理工作,在复杂冗长代码中不会漏掉. 比如执行回调,关闭文件,释放内存</li></ul></li><li>用朴素直观的算法<ul><li>在非关键路径上,优先使用朴素直观,维护性好的代码.</li></ul></li><li>用轮询代替条件变量<ul><li>非关键路径上这么做,代码间接,不容易出bug</li><li>轮询: 一直等待信号</li></ul></li><li>在关键对象增加magic字段<ul><li>增加magic字段和断言检查,可以及时发现内存错误</li></ul></li></ul><h2 id="2-测试"><a href="#2-测试" class="headerlink" title="2 测试"></a>2 测试</h2><ul><li><p>边界</p></li><li><p>状态&#x2F;分支测试</p></li><li><p>重复&#x2F;幂等性测试</p></li><li><p>兼容性测试</p></li><li><p>防御性测试</p><ul><li>关注系统在最差情况下的表现,明确能力边界</li></ul></li><li><p>避免写出不稳定case</p><ul><li><p>例</p></li><li><blockquote><ul><li>测试不聚焦，无脑复制粘贴，等价类测试爆炸</li><li>异步等待，基于时间假设，sleep 并发，未能在预期的窗口期交互</li><li>有顺序依赖的测试，共享某个状态</li><li>资源溢出，数据库链接满、内存 OOM 析构随机 core</li><li>析构未严格保序或者未构造</li><li>多线程共享资源的错误用法导致概率 crash</li><li>有未处理完的任务就退出</li></ul></blockquote></li></ul></li></ul><h2 id="3-提交"><a href="#3-提交" class="headerlink" title="3 提交"></a>3 提交</h2><ol><li>一次提交不要超过400行代码,最好只解决一个问题</li><li>自我检查<ol><li>速度&lt;500行&#x2F;小时</li><li>一次review时间不超过1小时</li><li>接口&gt;测试&gt;实现</li></ol></li></ol><h2 id="4-高效工作方法"><a href="#4-高效工作方法" class="headerlink" title="4 高效工作方法"></a>4 高效工作方法</h2><ul><li><p>抽象和分而治之</p><ul><li>抽象:明确模块之间的依赖关系,确定API接口</li><li>分而治之:对子系统设计进行合理的注释,帮助理解</li><li>代码提交尽量做到原子[不可分割的特性.修复.优化],测试代码一同提交</li></ul></li><li><p>不要重复</p><ul><li>寻找重复逻辑和代码,并进行封装</li><li>寻找流程重复,使用脚本或者工具自动化</li><li>沉淀踩坑经验</li></ul></li><li><p>快速迭代</p><ul><li>不要过度设计</li><li>尽快让代码运行和快速验证,不断迭代来完善</li><li>为了快速验证,本地测试成本低</li><li>实现一个可运行的脚手架,再持续添加内容</li></ul></li><li><p>忌“太心急”，慢即是快</p></li><li><ul><li>需求澄清：类似 TCP 三次握手，用自己理解的方式再给对方讲一遍，确认双方理解一致，对焦，避免重复返工</li><li>自我提问：为什么做这件事？业务价值是什么？关键技术是什么？已有的系统和它对比有什么不同？兄弟团队是否做过类似的工作？是否有经验可供参考？业务&#x2F;技术的适用场景是什么？预计耗时和进度风险？</li><li>新人往往脚踏实地，忘记了仰望星空，只顾着埋头苦干，不思考背后的业务价值，这一锄头，那一铁锹，遍地都是坑，就是不开花，费时费力，成就感低。</li></ul></li><li><p>忌低效沟通，用数据说话</p></li><li><ul><li>精确地描述问题，上下文和范围，提供有效信息</li><li>文档是提高沟通效率的最佳方式之一，Google 有文档文化，推荐阅读《Design Docs at Google》﻿[5]</li><li>Bad Case：「测试 CX6 网卡时，IOPS 大幅下降」</li><li>Good Case：「在 100g 网络标卡 CX6 验证性能时，8 jobs 32 depth iosize 4K 场景下，极限 IOPS 从 120 万下降至 110 万，与 FIC 卡相比性能存在 8% 差异」</li></ul></li><li><p>忌“蠢问题”，学会提问</p></li><li><ul><li>鼓励新人多提问，但提问的问题一定要有质量</li><li>关于如何提出一个好问题推荐阅读《提问的智慧》﻿[6]</li><li>Bad Case：「我在编译耗时很长，我怀疑是资源不够，这种情况怎么办？」</li><li>Good Case：「我的开发机编译耗时 2 小时，不符合预期，OS 是 centOS 7U、128GB 内存、64Core，编译并发度是 20 核，未限制内存，编译过程使用 Top 查看确实 20 核并发，Cpu 和 Mem没有达到瓶颈，iostat 看磁盘使用率每秒 60%」</li></ul></li><li></li><li><h2 id="5-延伸阅读"><a href="#5-延伸阅读" class="headerlink" title="5 延伸阅读"></a>5 延伸阅读</h2></li><li><blockquote><p>编写可读代码的艺术</p><p>software Engineer at Google</p><p>人月神话</p><p>数据密集型应用系统设计</p></blockquote></li><li></li></ul><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right:calc(50% - 1px);order:1;border-right:1px solid #fe2;padding-left:unset;max-width:calc(50% - 4px)"><a href="/2022/10/13/1013%20%E5%BC%82%E5%B8%B8%E6%8E%A7%E5%88%B6%E6%B5%81/">← Next csapp 异常控制流</a></div><div id="footer-link" style="left:50%;order:0;border-left:1px solid #fe2;padding-right:unset;max-width:calc(50% - 5px)"><a href="/2022/10/12/1012%20Linking/">CSAPP Linking 笔记 Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onclick="scrolls.scrolltop()" title="to top" style="opacity:0;display:none">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yue-plus">YSH</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%95%B4%E6%B4%81%E6%80%A7"><span class="toc-number">1.</span> <span class="toc-text">1 整洁性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%B5%8B%E8%AF%95"><span class="toc-number">2.</span> <span class="toc-text">2 测试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%8F%90%E4%BA%A4"><span class="toc-number">3.</span> <span class="toc-text">3 提交</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E9%AB%98%E6%95%88%E5%B7%A5%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">4 高效工作方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E5%BB%B6%E4%BC%B8%E9%98%85%E8%AF%BB"><span class="toc-number">5.</span> <span class="toc-text">5 延伸阅读</span></a></li></ol></div></div></div><footer><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr>Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=e=>{new Valine({el:"#Valine",appId:"MkE8c5Abvy4XAwiLVVgu2cbC-gzGzoHsz",appKey:"IYs46cd4ti4DN1JUw7aNIRVj",placeholder:"此条评论委托企鹅物流发送"}),code.findCode(),mermaid.init(void 0,".mermaid")}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>