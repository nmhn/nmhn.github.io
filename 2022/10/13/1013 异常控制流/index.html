<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>csapp 异常控制流 | Hexo</title><link rel="apple-touch-icon" sizes="57x57" href="/images/webclip/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/webclip/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/webclip/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/webclip/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/webclip/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/webclip/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/webclip/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/webclip/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="167x167" href="/images/webclip/apple-touch-icon-167x167.png"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"></head><body><main class="main"><header class="header"><div class="container"><nav class="navbar d-flex align-items-center"><a class="brand" href="/"><img class="logo lazyload" data-src="/images/brand.svg" alt="Hexo" role="img"></a><ul class="main-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></nav><a id="mobile-nav-toggle"><span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span></a></div></header><section><div class="container"><article id="post-1013 异常控制流" class="article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="artcle-cover mb-5"></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">csapp 异常控制流</h1><div class="article-meta"><time class="text-gray" datetime="2022-10-13T02:43:00.000Z" itemprop="datePublished">2022-10-13</time><div class="article-category"><a class="article-category-link" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></div></div></header><div class="article-entry" itemprop="articleBody"><h1 id="1013-异常控制流"><a href="#1013-异常控制流" class="headerlink" title="1013 异常控制流"></a>1013 异常控制流</h1><h3 id="Exception-Control-Flow-ECF"><a href="#Exception-Control-Flow-ECF" class="headerlink" title="Exception Control Flow ECF"></a>Exception Control Flow ECF</h3><h2 id="1-1-异常处理"><a href="#1-1-异常处理" class="headerlink" title="1.1 异常处理"></a>1.1 异常处理</h2><blockquote><p>启动时生成<strong>异常表</strong></p><p>运行时检测到异常,确定异常号,查找异常表,进入处理程序</p><p>执行完后,执行一条”从中断返回”指令,将控制返回给被中断的程序[如果是一个用户程序被中断]</p></blockquote><h2 id="1-2异常类别"><a href="#1-2异常类别" class="headerlink" title="1.2异常类别"></a>1.2异常类别</h2><ol><li><p>中断</p></li><li><p>陷阱和系统调用</p><blockquote><p>陷阱: 有意的异常,用来在用户程序和内核之间提供一个像过程一样的接口–系统调用</p></blockquote></li><li><p>故障</p><blockquote><p>如 除法错误,却也,一般保护故障[程序引用了一个未定义的虚拟内存区域,Linux一般会报告为一个 段故障 Segmentation fault]</p></blockquote></li><li><p>终止</p><blockquote><p>不可恢复的致命错误–通常硬件错误</p></blockquote></li></ol><h2 id="2-进程"><a href="#2-进程" class="headerlink" title="2 进程"></a>2 进程</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><blockquote><p>一个执行中程序的实例</p></blockquote><p>维护一个 该程序是系统中当前运行的唯一程序的假象</p><p>拥有</p><ul><li>一个独立的逻辑控制流<ul><li>提供独占处理器的假象</li></ul></li><li>一个私有的地址空间<ul><li>提供独占内存系统的假象</li></ul></li></ul><h3 id="进程空间"><a href="#进程空间" class="headerlink" title="进程空间"></a>进程空间</h3><p>给出通用结构</p><blockquote><p>以x86-64 Linux为例</p><img src="assets/image-20221013142209341.png" alt="image-20221013142209341" style="zoom:50%"></blockquote><h3 id="上下文切换"><a href="#上下文切换" class="headerlink" title="上下文切换"></a>上下文切换</h3><p>用于实现多任务</p><p>上下文: 重新启动一个被抢占的进程所需的状态</p><h2 id="系统调用错误处理"><a href="#系统调用错误处理" class="headerlink" title="系统调用错误处理"></a>系统调用错误处理</h2><p>Unix系统级函数遇到错误时,通常会返回-1,并设置全局整数变量errno来表示什么出错了.</p><h2 id="进程控制"><a href="#进程控制" class="headerlink" title="进程控制"></a>进程控制</h2><p>重点是创建子进程</p><p>父进程调用fork函数创建一个子进程</p><h3 id="父子进程区别"><a href="#父子进程区别" class="headerlink" title="父子进程区别"></a>父子进程区别</h3><blockquote><p>相同</p><ul><li>虚拟地址空间<ul><li>代码</li><li>数据段</li><li>堆</li><li>共享库</li><li>用户栈</li></ul></li><li>打开描述符<ul><li>意味着父进程调用fork时,子进程可以读写父进程中打开的任何文件</li></ul></li></ul><p>区别</p><ul><li>Pid<ul><li>进程id不同</li></ul></li><li>并发执行<ul><li>父进程和子进程是并发运行的独立进程</li></ul></li><li>虚拟地址空间<ul><li><strong>子进程得到的副本和父进程相同,包括打开的文件描述符,但是是一份独立的副本,也就是说,之后的调用,子进程和父进程独立.</strong></li></ul></li></ul></blockquote><p>fork</p><ul><li>调用一次返回两次<ul><li>一次是在调用进程(父进程中)<ul><li>返回子进程PID(非零)</li></ul></li><li>一次在创建的进程中(子进程中)<ul><li>返回0</li></ul></li></ul></li><li>可以用来辨认子进程还是父进程</li></ul><h3 id="回收子进程"><a href="#回收子进程" class="headerlink" title="回收子进程"></a>回收子进程</h3><p>步骤: 终止-&gt;分配给init进程作为养父-&gt;父进程回收[若父进程没来得及回收,则由init进程回收]</p><h2 id="信号"><a href="#信号" class="headerlink" title="信号"></a>信号</h2><p>较高层</p><ul><li>是一个小消息,通知进程系统中发生了一个某种类型的事件.</li><li>用于通知用户进程发生了一些低层的硬件异常</li></ul></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/csapp/" rel="tag">csapp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul></footer></div><nav class="article-nav pt-4 mt-3" id="article-nav"><a href="/2022/10/13/1013%E7%BC%96%E5%86%99%E5%8F%AF%E8%AF%BB%E4%BB%A3%E7%A0%81%E7%9A%84%E8%89%BA%E6%9C%AF%20%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">编码技巧 笔记</div></a><a href="/2022/10/12/1012%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">编码技巧 笔记</div></a></nav></article></div></section><footer class="footer pt-5 mt-5"><div class="container"><div class="py-3"><div class="row justify-content-between"><div class="col-6"><img class="filter-gray mb-3 lazyload" height="40" data-src="/images/brand.svg" alt="Hexo" role="img"><p class="mb-4"></p><ul class="list-inline"></ul></div><div class="col-4"><h5>友情链接</h5><ul class="list-inline"></ul></div></div></div><hr class="hr" style="opacity:.25"><div class="pt-3 pb-5"><ul class="list-inline mb-0 text-center"><li class="list-inline-item">&copy; 2023 Hexo</li><li class="list-inline-item">Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li><li class="list-inline-item">Designer <a href="https://acorn.imaging.xin/" target="_blank">YSH</a></li></ul></div></div></footer></main><div id="mobile-nav-dimmer"></div><div id="mobile-nav"><div id="mobile-nav-inner"><ul class="mobile-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></div></div><script src="/libs/feather/feather.min.js"></script><script src="/libs/lazysizes/lazysizes.min.js"></script><script src="/libs/tocbot/tocbot.min.js"></script><script>tocbot.init({tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h2, h3",hasInnerContainers:!0})</script><script src="/js/mobile-nav.js"></script><script src="/js/script.js"></script></body></html>