<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>数据库完整性概述 | Hexo</title><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>var config={root:"/",path:"search.json"}</script><script src="//unpkg.com/mermaid@8.13.5/dist/mermaid.min.js"></script><script>mermaid.initialize({startOnLoad:!0,theme:"dark"})</script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face{font-family:BenderLight;src:local('Bender'),url(/font/BenderLight.ttf)}@font-face{font-family:'JetBrains Mono';src:local('JetBrains Mono'),url(/font/JetBrainsMono-Regular.woff2) format('woff2')}</style><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg)"><main><header class="closed"><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></span></li><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>数据库完整性概述</h1><div id="post-info"><span>First Post:<div class="control"><time datetime="2021-12-06T12:43:23.000Z" id="date">2021-12-06</time></div></span><br><span>Last Update:<div class="control"><time datetime="2022-10-12T04:37:28.040Z" id="updated">2022-10-12</time></div></span><br><span>Word Count:<div class="control">826</div></span><br><span>Read Time:<div class="control">2 min</div></span></div></div><hr><div id="post-content"><p>9.1 数据库完整性概述</p><p>数据库完整性–数据的正确性,有效性,西安共性</p><p>列级约束</p><p>对属性的数据类型,等的定义</p><p>元祖约束</p><p>元组中各个属性之间的约束关系</p><h4 id="实现完整性约束的方法"><a href="#实现完整性约束的方法" class="headerlink" title="实现完整性约束的方法"></a>实现完整性约束的方法</h4><ol><li>提供定义机制</li><li>提供检查方法</li><li>违约处理</li></ol><h2 id="9-4用户定义的完整性"><a href="#9-4用户定义的完整性" class="headerlink" title="9.4用户定义的完整性"></a>9.4用户定义的完整性</h2><h2 id="9-5触发器"><a href="#9-5触发器" class="headerlink" title="9.5触发器"></a>9.5触发器</h2><p>一类用户定义在关系数据表上的一类由事件驱动的特殊过程,用编程的方法实现复杂的业务规则</p><p>是一种特殊类型的存储过程</p><p>可用触发器完成很多数据库完整性保护的过程</p><ol><li>复杂的业务规则</li><li>比较数据修改前后状态</li></ol><p>SQL:CREATE TRIGER命令</p><h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>原子性:不可分割</p><p>一致性:事务执行结果必须从一个状态转换到另一个状态时保持一致,即若中间出现错误,则将所有操作撤销</p><p>事务应当具有ACID性质，<br>A是<strong>原子</strong>性(atomic)：事务中包含的各项操作必须全部成功执行或者全部不执行。任何一项操作失败，将导致整个事务失败，其他已经执行的任务所作的数据操作都将被撤销，只有所有的操作全部成功，整个事务才算是成功完成。<br>C是<strong>一致性</strong>(consistent)：保证了当事务结束后，系统状态是一致的。那么什么是一致的系统状态？例如，如果银行始终遵循着”银行账号必须保持正态平衡”的原则，那么银行系统的状态就是一致的。上面的转账例子中，在取钱的过程中，账户会出现负态平衡，在事务结束之后，系统又回到一致的状态。这样，系统的状态对于客户来说，始终是一致的。<br>I是<strong>隔离</strong>性(isolated)：使得并发执行的事务，彼此无法看到对方的中间状态。保证了并发执行的事务顺序执行，而不会导致系统状态不一致。<br>D是<strong>持久性</strong>(durable)：保证了事务完成后所作的改动都会被持久化，即使是发生灾难性的失败。可恢复性资源保存了一份事务日志，如果资源发生故障，可以通过日志来将数据重建起来。</p><p>事务应处在下列状态之一</p><p>活动状态</p><p>失败状态:意味着要回滚</p><p>中止状态:数据库已经回滚完毕,恢复到提交前状态</p><p>提交状态:当数据更改完全写入磁盘时,进入提交状态</p><p>10.3.1事务故障的恢复</p><p>1.反向扫描日文件日志,查找该事务的更新操作</p><p>2.对该事务的更新操作执行你操作</p><p>3.继续反向扫描,直到读到此事务的开始操作</p><p>10.3.2系统故障恢复</p><p>1.<strong>正向</strong>扫描日志文件,列出Redo队列,Undo队列</p><h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p><code>&lt;u&gt;</code><strong>登记两条原则</strong> <code>&lt;/u&gt;</code></p><p><code>&lt;u&gt;</code><strong>1.登记次序严格按并行事物执行顺序</strong> <code>&lt;/u&gt;</code></p><p><code>&lt;u&gt;</code><strong>2.先写日志文件,后写数据库</strong> <code>&lt;/u&gt;</code></p><div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right:calc(50% - 1px);order:1;border-right:1px solid #fe2;padding-left:unset;max-width:calc(50% - 4px)"><a href="/2021/12/06/2021-12-06-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/">← Next 21/12/6 Database 数据库操作</a></div><div id="footer-link" style="left:50%;order:0;border-left:1px solid #fe2;padding-right:unset;max-width:calc(50% - 5px)"><a href="/2021/12/06/2021-12-06-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/">21/12/6 Database 查询优化 Prev →</a></div></div></div><div id="Valine"></div></div><div id="bottom-btn"><a id="to-index" href="#toc-div" title="index">≡</a><a id="to-top" onclick="scrolls.scrolltop()" title="to top" style="opacity:0;display:none">∧</a></div></article><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://github.com/Yue-plus">YSH</a></h1><div id="description"></div></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%AE%8C%E6%95%B4%E6%80%A7%E7%BA%A6%E6%9D%9F%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">实现完整性约束的方法</span></a></li></ol><li class="toc-item toc-level-2"><a class="toc-link" href="#9-4%E7%94%A8%E6%88%B7%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%8C%E6%95%B4%E6%80%A7"><span class="toc-number"></span> <span class="toc-text">9.4用户定义的完整性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-5%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-number"></span> <span class="toc-text">9.5触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1"><span class="toc-number"></span> <span class="toc-text">事务</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97"><span class="toc-number"></span> <span class="toc-text">日志</span></a></li></ol></li></div></div></div><footer><nobr>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr>Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr></footer></aside></main><div id="cursor-container"><div id="cursor-outer"></div><div id="cursor-effect"></div></div><script src="/js/search.js"></script><script class="pjax-js">reset=e=>{new Valine({el:"#Valine",appId:"MkE8c5Abvy4XAwiLVVgu2cbC-gzGzoHsz",appKey:"IYs46cd4ti4DN1JUw7aNIRVj",placeholder:"此条评论委托企鹅物流发送"}),code.findCode(),mermaid.init(void 0,".mermaid")}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>window.addEventListener("load",()=>{reset()})</script></body></html>