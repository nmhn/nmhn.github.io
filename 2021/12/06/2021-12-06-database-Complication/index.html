<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>数据库完整性概述 | Hexo</title><link rel="apple-touch-icon" sizes="57x57" href="/images/webclip/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/webclip/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/webclip/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/webclip/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/webclip/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/webclip/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/webclip/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/webclip/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="167x167" href="/images/webclip/apple-touch-icon-167x167.png"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"></head><body><main class="main"><header class="header"><div class="container"><nav class="navbar d-flex align-items-center"><a class="brand" href="/"><img class="logo lazyload" data-src="/images/brand.svg" alt="Hexo" role="img"></a><ul class="main-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></nav><a id="mobile-nav-toggle"><span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span></a></div></header><section><div class="container"><article id="post-2021-12-06-database-Complication" class="article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="artcle-cover mb-5"></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">数据库完整性概述</h1><div class="article-meta"><time class="text-gray" datetime="2021-12-06T12:43:23.000Z" itemprop="datePublished">2021-12-06</time></div></header><div class="article-entry" itemprop="articleBody"><p>9.1 数据库完整性概述</p><p>数据库完整性–数据的正确性,有效性,西安共性</p><p>列级约束</p><p>对属性的数据类型,等的定义</p><p>元祖约束</p><p>元组中各个属性之间的约束关系</p><h4 id="实现完整性约束的方法"><a href="#实现完整性约束的方法" class="headerlink" title="实现完整性约束的方法"></a>实现完整性约束的方法</h4><ol><li>提供定义机制</li><li>提供检查方法</li><li>违约处理</li></ol><h2 id="9-4用户定义的完整性"><a href="#9-4用户定义的完整性" class="headerlink" title="9.4用户定义的完整性"></a>9.4用户定义的完整性</h2><h2 id="9-5触发器"><a href="#9-5触发器" class="headerlink" title="9.5触发器"></a>9.5触发器</h2><p>一类用户定义在关系数据表上的一类由事件驱动的特殊过程,用编程的方法实现复杂的业务规则</p><p>是一种特殊类型的存储过程</p><p>可用触发器完成很多数据库完整性保护的过程</p><ol><li>复杂的业务规则</li><li>比较数据修改前后状态</li></ol><p>SQL:CREATE TRIGER命令</p><h1 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h1><p>原子性:不可分割</p><p>一致性:事务执行结果必须从一个状态转换到另一个状态时保持一致,即若中间出现错误,则将所有操作撤销</p><p>事务应当具有ACID性质，<br>A是<strong>原子</strong>性(atomic)：事务中包含的各项操作必须全部成功执行或者全部不执行。任何一项操作失败，将导致整个事务失败，其他已经执行的任务所作的数据操作都将被撤销，只有所有的操作全部成功，整个事务才算是成功完成。<br>C是<strong>一致性</strong>(consistent)：保证了当事务结束后，系统状态是一致的。那么什么是一致的系统状态？例如，如果银行始终遵循着”银行账号必须保持正态平衡”的原则，那么银行系统的状态就是一致的。上面的转账例子中，在取钱的过程中，账户会出现负态平衡，在事务结束之后，系统又回到一致的状态。这样，系统的状态对于客户来说，始终是一致的。<br>I是<strong>隔离</strong>性(isolated)：使得并发执行的事务，彼此无法看到对方的中间状态。保证了并发执行的事务顺序执行，而不会导致系统状态不一致。<br>D是<strong>持久性</strong>(durable)：保证了事务完成后所作的改动都会被持久化，即使是发生灾难性的失败。可恢复性资源保存了一份事务日志，如果资源发生故障，可以通过日志来将数据重建起来。</p><p>事务应处在下列状态之一</p><p>活动状态</p><p>失败状态:意味着要回滚</p><p>中止状态:数据库已经回滚完毕,恢复到提交前状态</p><p>提交状态:当数据更改完全写入磁盘时,进入提交状态</p><p>10.3.1事务故障的恢复</p><p>1.反向扫描日文件日志,查找该事务的更新操作</p><p>2.对该事务的更新操作执行你操作</p><p>3.继续反向扫描,直到读到此事务的开始操作</p><p>10.3.2系统故障恢复</p><p>1.<strong>正向</strong>扫描日志文件,列出Redo队列,Undo队列</p><h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><p><code>&lt;u&gt;</code><strong>登记两条原则</strong> <code>&lt;/u&gt;</code></p><p><code>&lt;u&gt;</code><strong>1.登记次序严格按并行事物执行顺序</strong> <code>&lt;/u&gt;</code></p><p><code>&lt;u&gt;</code><strong>2.先写日志文件,后写数据库</strong> <code>&lt;/u&gt;</code></p></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/exp8/" rel="tag">exp8</a></li></ul></footer></div><nav class="article-nav pt-4 mt-3" id="article-nav"><a href="/2021/12/06/2021-12-06-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">21/12/6 Database 数据库操作</div></a><a href="/2021/12/06/2021-12-06-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">21/12/6 Database 查询优化</div></a></nav></article></div></section><footer class="footer pt-5 mt-5"><div class="container"><div class="py-3"><div class="row justify-content-between"><div class="col-6"><img class="filter-gray mb-3 lazyload" height="40" data-src="/images/brand.svg" alt="Hexo" role="img"><p class="mb-4"></p><ul class="list-inline"></ul></div><div class="col-4"><h5>友情链接</h5><ul class="list-inline"></ul></div></div></div><hr class="hr" style="opacity:.25"><div class="pt-3 pb-5"><ul class="list-inline mb-0 text-center"><li class="list-inline-item">&copy; 2023 Hexo</li><li class="list-inline-item">Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li><li class="list-inline-item">Designer <a href="https://acorn.imaging.xin/" target="_blank">YSH</a></li></ul></div></div></footer></main><div id="mobile-nav-dimmer"></div><div id="mobile-nav"><div id="mobile-nav-inner"><ul class="mobile-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></div></div><script src="/libs/feather/feather.min.js"></script><script src="/libs/lazysizes/lazysizes.min.js"></script><script src="/libs/tocbot/tocbot.min.js"></script><script>tocbot.init({tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h2, h3",hasInnerContainers:!0})</script><script src="/js/mobile-nav.js"></script><script src="/js/script.js"></script></body></html>