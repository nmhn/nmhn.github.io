<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>网络层 | Hexo</title><link rel="apple-touch-icon" sizes="57x57" href="/images/webclip/apple-touch-icon-57x57.png"><link rel="apple-touch-icon" sizes="72x72" href="/images/webclip/apple-touch-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/images/webclip/apple-touch-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/images/webclip/apple-touch-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/images/webclip/apple-touch-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/images/webclip/apple-touch-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/images/webclip/apple-touch-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/images/webclip/apple-touch-icon-180x180.png"><link rel="apple-touch-icon" sizes="167x167" href="/images/webclip/apple-touch-icon-167x167.png"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml"></head><body><main class="main"><header class="header"><div class="container"><nav class="navbar d-flex align-items-center"><a class="brand" href="/"><img class="logo lazyload" data-src="/images/brand.svg" alt="Hexo" role="img"></a><ul class="main-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></nav><a id="mobile-nav-toggle"><span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span> <span class="mobile-nav-toggle-bar"></span></a></div></header><section><div class="container"><article id="post-2021-12-09-计网网络层" class="article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="artcle-cover mb-5"></div><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name">网络层</h1><div class="article-meta"><time class="text-gray" datetime="2021-12-09T02:48:15.000Z" itemprop="datePublished">2021-12-09</time></div></header><div class="article-entry" itemprop="articleBody"><h1 id="网络层-控制平面"><a href="#网络层-控制平面" class="headerlink" title="网络层-控制平面"></a>网络层-控制平面</h1><h2 id="路由算法"><a href="#路由算法" class="headerlink" title="路由算法"></a>路由算法</h2><h6 id="产生路由表的算法"><a href="#产生路由表的算法" class="headerlink" title="产生路由表的算法"></a>产生路由表的算法</h6><h3 id="图论抽象"><a href="#图论抽象" class="headerlink" title="图论抽象"></a>图论抽象</h3><p>Graph: G &#x3D; <strong>(N,E)</strong></p><p><strong>N</strong> &#x3D; set of routers &#x3D; { u, v, w, x, y, z } 节点是<strong>路由器</strong></p><p><strong>E</strong> &#x3D; set of links &#x3D;{ (u,v), (u,x), (v,x), (v,w), (x,w), (x,y), (w,y), (w,z), (y,z) } 边是<strong>物理链路</strong></p><p>链路开销Cost of link：时延、费用或拥塞等级 路径开销Cost of path：c(x1 , x2 , x3 ,…, xp ) &#x3D; c(x1 ,x2 ) + c(x2 ,x3 ) + … + c(xp-1 ,xp )</p><p><strong>路由算法</strong>：找到开销最小的路径(路由器序列)</p><p><strong>分散式</strong>算法–只知道和部分路径,通过和邻居交换信息</p><p>典型就是下面这个算法</p><h3 id="•-距离向量路由算法"><a href="#•-距离向量路由算法" class="headerlink" title="• 距离向量路由算法"></a>• 距离向量路由算法</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><ol><li><p>节点x维护距离向量</p><p>Dx&#x3D;[dx (y): yєN ]<br>(如果y不是x的邻居节点, 则dx (y)&#x3D;∞,否则dx (y)&#x3D; c(x,y))</p></li><li><p>每个节点周期性向其邻居节点发送它自己的 距离向量, 节点x保存其邻居节点的距离向量<br>Dv &#x3D; [dv (y): y є N ]</p></li><li><p>n当节点x接收到来自邻居的 新距离向量，它使用B-F方程更新自己的DV :<br>Dx (y) ← minv {c(x,v) + Dv (y)} for each node y ∊ N<br>Bellman-Ford方程：</p><ol><li>定义<br>$d_x$ (y) &#x3D; 从x到y的最小开销路径的开销,c(x,v) &#x3D; 从x到邻居节点v的链路的开销</li><li>则dx (y) &#x3D; minv {c(x,v) + dv (y) }</li><li>取值最小的节点对应最短路径中的<strong>下一跳</strong>(只有一个地址)➜ 转发表</li></ol><p>示例<code>&lt;img src=&quot;https://s2.loli.net/2021/12/09/HhICGUakqft2zm1.png&quot; alt=&quot;image-20211122134953146&quot; style=&quot;zoom:50%;&quot; /&gt;</code></p></li></ol><h3 id="•-链路状态路由算法-•"><a href="#•-链路状态路由算法-•" class="headerlink" title="• 链路状态路由算法 •"></a>• 链路状态路由算法 •</h3><ol><li>Discover its neighbors, learn their network address. <strong>发现邻居，学习它们的网络地址</strong></li><li>Measure the delay or cost to each of its neighbors. <strong>测量到每一个邻居的时延或开销</strong></li><li>Construct a packet (link state packet)telling all it has just learned. <strong>构造一个分组(链路状态分组) 来通 告其学习到的所有信息</strong></li><li>Send this packet to all other routers. <strong>向所有路由器发送该分组</strong></li><li>Compute the shortest path to every other router. <strong>计算到其他路由器的最短路径</strong><br>使用Dijkstra算法计算最短路径<br><code>&lt;img src=&quot;https://s2.loli.net/2021/12/09/mCdF4G2wO7vxpUW.png&quot; alt=&quot;image-20211122143134224&quot; style=&quot;zoom:50%;&quot; /&gt;</code></li></ol><h2 id="路由协议"><a href="#路由协议" class="headerlink" title="路由协议"></a>路由协议</h2><p>受到分组压力,单位需求的影响,产生了as(自治系统)</p><p>系统内可以用之前的算法,系统外–?自治系统间专门的路由协议</p><h3 id="•-O-pen-S-hortest-P-ath-F-irst-路由协议"><a href="#•-O-pen-S-hortest-P-ath-F-irst-路由协议" class="headerlink" title="• O(pen)S(hortest)P(ath)F(irst)路由协议"></a>• O(pen)S(hortest)P(ath)F(irst)路由协议</h3><h5 id="自治系统内路由-开放最短路径优先"><a href="#自治系统内路由-开放最短路径优先" class="headerlink" title="自治系统内路由-开放最短路径优先"></a>自治系统内路由-开放最短路径优先</h5><h6 id="使用的算法是链路状态算法"><a href="#使用的算法是链路状态算法" class="headerlink" title="使用的算法是链路状态算法"></a>使用的算法是<strong>链路状态算法</strong></h6><p>OSPF的特点</p><ol><li>安全性–报文经过签名鉴别</li><li>使用多条开销相同的路径</li><li>对每条链路,为不同的服务类型设置多种开销度量</li><li>集成的单播和多播支持</li></ol><h5 id="层次ospf"><a href="#层次ospf" class="headerlink" title="层次ospf"></a>层次ospf</h5><p>自治系统内进一步再分</p><h3 id="•-BGP路由协议-border-gateway-protocol"><a href="#•-BGP路由协议-border-gateway-protocol" class="headerlink" title="• BGP路由协议(border gateway protocol)"></a>• BGP路由协议(border gateway protocol)</h3><h5 id="自治系统间路由"><a href="#自治系统间路由" class="headerlink" title="-自治系统间路由"></a>-自治系统间路由</h5><p>算法-距离向量算法(改名—路径向量算法)</p><ol><li>eBGP: Obtain subnet reachability information from</li></ol><p>neighboring ASes.从相邻AS获得子网可达性信息</p><ol start="2"><li>iBGP: Propagate reachability information to all AS-internal</li></ol><p>routers. 向AS内部的所有路由器传播可达性信息</p><ol start="3"><li>Determine “good” routes to subnets based on reachability</li></ol><p>information and policy.根据可达性信息和策略，决定到子网</p><p>的“好”路由</p><h2 id="•ICMP-The-Internet-Control"><a href="#•ICMP-The-Internet-Control" class="headerlink" title="•ICMP-The Internet Control"></a>•ICMP-The Internet Control</h2><p>差错报告–不可达网络\主机\端口\协议</p><p>回声请求</p><p>trace route</p><p>源主机从ttl&#x3D;1,一点点开始发送更大的ttl,目的端口号设置为一个不可能到达的端口,</p><p>当ttl超时时,该路由器发送一个ICMP报文到源主机,这样会获取路径上路由器的信息</p><p>到达目的主机后,会返回一个端口不可达报文,探测结束</p><h2 id="Message-Protocol"><a href="#Message-Protocol" class="headerlink" title="Message Protocol"></a>Message Protocol</h2><h2 id="•网络管理——SNMP协议"><a href="#•网络管理——SNMP协议" class="headerlink" title="•网络管理——SNMP协议"></a>•网络管理——SNMP协议</h2></div><footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%B1%82/" rel="tag">网络层</a></li></ul></footer></div><nav class="article-nav pt-4 mt-3" id="article-nav"><a href="/2021/12/09/2021-12-09-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2/" id="article-nav-newer" class="article-nav-link-wrap"><strong class="article-nav-caption">Newer</strong><div class="article-nav-title">网络地址转换</div></a><a href="/2021/12/09/2021-12-09-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/" id="article-nav-older" class="article-nav-link-wrap"><strong class="article-nav-caption">Older</strong><div class="article-nav-title">计网笔记-数据链路层</div></a></nav></article></div></section><footer class="footer pt-5 mt-5"><div class="container"><div class="py-3"><div class="row justify-content-between"><div class="col-6"><img class="filter-gray mb-3 lazyload" height="40" data-src="/images/brand.svg" alt="Hexo" role="img"><p class="mb-4"></p><ul class="list-inline"></ul></div><div class="col-4"><h5>友情链接</h5><ul class="list-inline"></ul></div></div></div><hr class="hr" style="opacity:.25"><div class="pt-3 pb-5"><ul class="list-inline mb-0 text-center"><li class="list-inline-item">&copy; 2023 Hexo</li><li class="list-inline-item">Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li><li class="list-inline-item">Designer <a href="https://acorn.imaging.xin/" target="_blank">YSH</a></li></ul></div></div></footer></main><div id="mobile-nav-dimmer"></div><div id="mobile-nav"><div id="mobile-nav-inner"><ul class="mobile-nav"><li class="nav-item"><a class="nav-item-link" href="/">首页</a></li><li class="nav-item"><a class="nav-item-link" href="/gallery">画廊</a></li><li class="nav-item"><a class="nav-item-link" href="/stories">案例</a></li><li class="nav-item"><a class="nav-item-link" href="/archives">文章</a></li><li class="nav-item"><a class="nav-item-link" href="/about">关于</a></li></ul></div></div><script src="/libs/feather/feather.min.js"></script><script src="/libs/lazysizes/lazysizes.min.js"></script><script src="/libs/tocbot/tocbot.min.js"></script><script>tocbot.init({tocSelector:".js-toc",contentSelector:".js-toc-content",headingSelector:"h2, h3",hasInnerContainers:!0})</script><script src="/js/mobile-nav.js"></script><script src="/js/script.js"></script></body></html>